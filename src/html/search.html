<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="color-scheme" content="light dark" />
        <title>SliDesk.link | A place for your slides</title>
        <link rel="icon" href="/public/slidesk.svg" type="image/svg+xml" />
        <link rel="icon" href="/public/slidesk.ico" type="image/x-icon" />
        <link
            rel="icon"
            href="/public/slidesk-32x32.png"
            type="image/png"
            sizes="32x32"
        />
        <link
            rel="apple-touch-icon"
            href="/public/slidesk-180x180.png"
            type="image/png"
            sizes="180x180"
        />
    </head>
    <body>
        <header>
            <nav class="container">
                <ul>
                    <li>
                        <a href="/">
                            <h1>SliDesk<span>.link</span></h1>
                        </a>
                    </li>
                </ul>
            </nav>
        </header>
        <main class="container">
            <form>
                <article>
                    <header>
                        Thanks to the community, plugins, components, users,
                        talks, etc. are available to enhance your slides.
                    </header>
                    <fieldset>
                        <input
                            type="text"
                            id="search_text"
                            placeholder="Type your search..."
                        />
                    </fieldset>
                    <footer>
                        <fieldset>
                            <legend>Search in:</legend>
                            <div id="checkboxes">
                                <label htmlFor="users">
                                    <input
                                        type="checkbox"
                                        value="users"
                                        id="users"
                                        name="filter"
                                        checked
                                    />
                                    Users
                                </label>
                                <label htmlFor="talks">
                                    <input
                                        type="checkbox"
                                        value="talks"
                                        id="talks"
                                        name="filter"
                                        checked
                                    />
                                    Talks
                                </label>
                                <label htmlFor="plugins">
                                    <input
                                        type="checkbox"
                                        value="plugins"
                                        id="plugins"
                                        name="filter"
                                        checked
                                    />
                                    Plugins
                                </label>
                                <label htmlFor="components">
                                    <input
                                        type="checkbox"
                                        value="components"
                                        id="components"
                                        name="filter"
                                        checked
                                    />
                                    Components
                                </label>
                            </div>
                        </fieldset>
                    </footer>
                </article>
            </form>
            <div id="results"></div>
        </main>
        #FOOTER
        <script>
            document
                .querySelector("form")
                .addEventListener("input", async (e) => {
                    const $results = document.querySelector("#results");
                    const searchText =
                        document.querySelector("#search_text").value;
                    $results.innerHTML = "";
                    if (searchText.length > 3) {
                        const { plugins, components, users, talks } = await (
                            await fetch(
                                `/search/${searchText}/${[...document.querySelectorAll('input[name="filter"]:checked')].map((e) => e.value).join(",")}`,
                                {
                                    method: "POST",
                                },
                            )
                        ).json();

                        const iconStatus = [
                            '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ticket-x-icon lucide-ticket-x"><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="m9.5 14.5 5-5"/><path d="m9.5 9.5 5 5"/></svg>',
                            '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ticket-check-icon lucide-ticket-check"><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="m9 12 2 2 4-4"/></svg>',
                            '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ticket-slash-icon lucide-ticket-slash"><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="m9.5 14.5 5-5"/></svg>',
                            '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ticket-minus-icon lucide-ticket-minus"><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M9 12h6"/></svg>',
                        ];
                        const textStatus = [
                            "Rejected",
                            "Accepted",
                            "Declined",
                            "Pending",
                        ];
                        const iconCalendar =
                            '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-days-icon lucide-calendar-days"><path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/></svg>';
                        const iconLink =
                            '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>';
                        const iconSlide =
                            '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-presentation-icon lucide-presentation"><path d="M2 3h20"/><path d="M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3"/><path d="m7 21 5-5 5 5"/></svg>';
                        const iconVideo =
                            '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clapperboard-icon lucide-clapperboard"><path d="M20.2 6 3 11l-.9-2.4c-.3-1.1.3-2.2 1.3-2.5l13.5-4c1.1-.3 2.2.3 2.5 1.3Z"/><path d="m6.2 5.3 3.1 3.9"/><path d="m12.4 3.4 3.1 4"/><path d="M3 11h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Z"/></svg>';

                        let html = ["USER", "TALK", "PLUGIN", "COMPONENT"]
                            .map((a) => `#${a}S`)
                            .join(" ");
                        if (plugins.length) {
                            html = html.replace(
                                "#PLUGINS",
                                `
                      <section>
                        <details open>
                          <summary>
                            <h2>
                              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-blocks-icon lucide-blocks"><path d="M10 22V7a1 1 0 0 0-1-1H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5a1 1 0 0 0-1-1H2"/><rect x="14" y="2" width="8" height="8" rx="1"/></svg>
                              Plugins
                            </h2>
                          </summary>
                          ${plugins
                              .map(
                                  (plugin) => `
                            <article>
                              <header>
                                <h3>
                                    ${plugin.slug}
                                    <small><code data-tooltip="${plugin.downloaded} download(s)">${plugin.downloaded}</code></small>
                                </h3>
                              </header>
                              <div>${plugin.description}</div>
                              <footer>
                                <code>slidesk plugin install @${plugin.user}/${plugin.slug}</code>
                                <a href="#" data-tooltip="copy command" onclick="navigator.clipboard.writeText('slidesk plugin install @${plugin.user}/${plugin.slug}');return false;">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy-icon lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                                </a>
                              </footer>
                            </article>`,
                              )
                              .join("")}
                        </details>
                      </section><hr/>
                          `,
                            );
                        } else html = html.replace("#PLUGINS", "");

                        if (components.length) {
                            html = html.replace(
                                "#COMPONENTS",
                                `
                      <section>
                        <details open>
                          <summary>
                            <h2>
                              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-toy-brick-icon lucide-toy-brick"><rect width="18" height="12" x="3" y="8" rx="1"/><path d="M10 8V5c0-.6-.4-1-1-1H6a1 1 0 0 0-1 1v3"/><path d="M19 8V5c0-.6-.4-1-1-1h-3a1 1 0 0 0-1 1v3"/></svg>
                              Components
                            </h2>
                          </summary>
                          ${components
                              .map(
                                  (component) => `
                            <article>
                              <header>
                                <h3>
                                    ${component.slug}
                                    <small><code data-tooltip="${component.downloaded} download(s)">${component.downloaded}</code></small>
                                </h3>
                              </header>
                              <div>${component.description}</div>
                              <footer>
                                <code>slidesk component install @${component.user}/${component.slug}</code>
                                <a href="#" data-tooltip="copy command" onclick="navigator.clipboard.writeText('slidesk plugin component @${component.user}/${component.slug}');return false;">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy-icon lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                                </a>
                              </footer>
                            </article>`,
                              )
                              .join("")}
                        </details>
                      </section><hr/>
                          `,
                            );
                        } else html = html.replace("#COMPONENTS", "");

                        if (users.length) {
                            html = html.replace(
                                "#USERS",
                                `
                      <section>
                        <details open>
                          <summary>
                            <h2>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users-icon lucide-users"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><path d="M16 3.128a4 4 0 0 1 0 7.744"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><circle cx="9" cy="7" r="4"/></svg>
                              Users
                            </h2>
                          </summary>
                          ${users
                              .map(
                                  (user) => `
                            <article>
                              <header>
                                <h3>
                                    ${user.name} (${user.slug})
                                </h3>
                              </header>
                              <div>${user.bio}</div>
                              <footer>
                                <a href="https://slidesk.link/u/${user.slug}" target="_blank">
                                  https://slidesk.link/u/${user.slug}
                                </a>
                              </footer>
                            </article>`,
                              )
                              .join("")}
                        </details>
                      </section><hr/>
                          `,
                            );
                        } else html = html.replace("#USERS", "");

                        if (talks.length) {
                            html = html.replace(
                                "#TALKS",
                                `
                      <section>
                        <details open>
                          <summary>
                            <h2>
                              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-megaphone-icon lucide-megaphone"><path d="M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z"/><path d="M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14"/><path d="M8 6v8"/></svg>
                              Talks
                            </h2>
                          </summary>
                          ${talks
                              .map(
                                  (talk) => `
                                  <article>
                                    <header>
                                      <h3>
                                          ${talk.title}
                                      </h3>
                                    </header>
                                    <div>${talk.abstract}</div>
                                    <footer>
                                        ${talk.Session.sort(
                                            (a, b) =>
                                                Number(b.date) - Number(a.date),
                                        )
                                            .filter((s) => s.status !== 0)
                                            .map(
                                                (s, _) => `
                                            <div>
                                              <span class="icon-status status-${s.status}" data-tooltip="${textStatus[s.status]}">${iconStatus[s.status]}</span>
                                              ${iconCalendar}
                                              ${new Date(s.date).toISOString().split("T")[0]}: ${s.location}
                                              ${
                                                  s.url
                                                      ? `<a href="${s.url}" data-tooltip="More info" aria-label="More info" target="_blank" rel="noopener">${iconLink}</a>`
                                                      : ""
                                              }
                                              ${
                                                  s.slides
                                                      ? `<a href="${s.slides}" data-tooltip="See presentation" aria-label="See presentation" target="_blank" rel="noopener">${iconSlide}</a>`
                                                      : ""
                                              }
                                              ${
                                                  s.video
                                                      ? `<a href="${s.video}" data-tooltip="See video" aria-label="See video" target="_blank" rel="noopener">${iconVideo}</a>`
                                                      : ""
                                              }
                                            </div>
                                          `,
                                            )
                                            .join("")}
                                    </footer>
                                </article>`,
                              )
                              .join("")}
                        </details>
                      </section><hr/>
                          `,
                            );
                        } else html = html.replace("#TALKS", "");

                        if (html.trim() === "") html = "<mark>no result</mark>";
                        else $results.innerHTML = html;
                    }
                });
        </script>
    </body>
</html>
