<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="color-scheme" content="light dark" />
        <title>SliDesk.link | A place for your slides</title>
        <link rel="icon" href="/public/slidesk.svg" type="image/svg+xml" />
        <link rel="icon" href="/public/slidesk.ico" type="image/x-icon" />
        <link
            rel="icon"
            href="/public/slidesk-32x32.png"
            type="image/png"
            sizes="32x32"
        />
        <link
            rel="apple-touch-icon"
            href="/public/slidesk-180x180.png"
            type="image/png"
            sizes="180x180"
        />
    </head>
    <body>
        <header>
            <nav class="container">
                <ul>
                    <li>
                        <a href="/">
                            <h1>SliDesk<span>.link</span></h1>
                        </a>
                    </li>
                </ul>
            </nav>
        </header>
        <main class="container">
            <article>
                <header>
                    Thanks to the community, plugins, components, etc. are
                    available to enhance your slides.
                </header>
                <form>
                    <fieldset>
                        <input
                            type="text"
                            name="slug"
                            placeholder="Find a plugin, component, ..."
                        />
                    </fieldset>
                </form>
            </article>
            <div id="results"></div>
        </main>
        #FOOTER
        <script>
            document
                .querySelector("form")
                .addEventListener("input", async (e) => {
                    const $results = document.querySelector("#results");
                    $results.innerHTML = "";
                    if (e.target.value.length > 3) {
                        const { plugins, components } = await (
                            await fetch(`/search/${e.target.value}`, {
                                method: "POST",
                            })
                        ).json();
                        let html = "#PLUGINS #COMPONENTS";
                        if (plugins.length) {
                            html = html.replace(
                                "#PLUGINS",
                                `
                      <section>
                        <details open>
                          <summary>
                            <h2>
                              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-blocks-icon lucide-blocks"><path d="M10 22V7a1 1 0 0 0-1-1H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5a1 1 0 0 0-1-1H2"/><rect x="14" y="2" width="8" height="8" rx="1"/></svg>
                              Plugins
                            </h2>
                          </summary>
                          ${plugins
                              .map(
                                  (plugin) => `
                            <article>
                              <header>
                                <h3 id="p${plugin.slug}">
                                    ${plugin.slug}
                                    <small><code data-tooltip="${plugin.downloaded} download(s)">${plugin.downloaded}</code></small>
                                </h3>
                              </header>
                              <div>${plugin.description}</div>
                              <footer>
                                <code>slidesk plugin install @${plugin.user}/${plugin.slug}</code>
                                <a href="#" data-tooltip="copy command" onclick="navigator.clipboard.writeText('slidesk plugin install @${plugin.user}/${plugin.slug}');return false;">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy-icon lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                                </a>
                              </footer>
                            </article>`,
                              )
                              .join("")}
                        </details>
                      </section><hr/>
                          `,
                            );
                        } else html = html.replace("#PLUGINS", "");

                        //#COMPONENTS
                        if (components.length) {
                            html = html.replace(
                                "#COMPONENTS",
                                `
                      <section>
                        <details open>
                          <summary>
                            <h2>
                              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-toy-brick-icon lucide-toy-brick"><rect width="18" height="12" x="3" y="8" rx="1"/><path d="M10 8V5c0-.6-.4-1-1-1H6a1 1 0 0 0-1 1v3"/><path d="M19 8V5c0-.6-.4-1-1-1h-3a1 1 0 0 0-1 1v3"/></svg>
                              Components
                            </h2>
                          </summary>
                          ${components
                              .map(
                                  (component) => `
                            <article>
                              <header>
                                <h3 id="c${component.slug}">
                                    ${component.slug}
                                    <small><code data-tooltip="${component.downloaded} download(s)">${component.downloaded}</code></small>
                                </h3>
                              </header>
                              <div>${component.description}</div>
                              <footer>
                                <code>slidesk component install @${component.user}/${component.slug}</code>
                                <a href="#" data-tooltip="copy command" onclick="navigator.clipboard.writeText('slidesk plugin component @${component.user}/${component.slug}');return false;">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy-icon lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                                </a>
                              </footer>
                            </article>`,
                              )
                              .join("")}
                        </details>
                      </section><hr/>
                          `,
                            );
                        } else html = html.replace("#COMPONENTS", "");
                        $results.innerHTML = html;
                    }
                });
        </script>
    </body>
</html>
